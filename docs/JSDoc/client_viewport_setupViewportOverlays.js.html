<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: client/viewport/setupViewportOverlays.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: client/viewport/setupViewportOverlays.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @author Francisco Maria Calisto &lt;francisco.calisto@tecnico.ulisboa.pt>
 */

function setupViewportOverlays(element, data) {
  var parent = $(element).parent();

  // Get the overlays
  var childDivs = $(parent).find('.overlay');
  var topLeft = $(childDivs[0]).find('div');
  var topRight = $(childDivs[1]).find('div');
  var bottomLeft = $(childDivs[2]).find('div');
  var bottomRight = $(childDivs[3]).find('div');

  // Set the overlay text
  $(topLeft[0]).text(data.patientName);
  $(topLeft[1]).text(data.patientId);
  $(topRight[0]).text(data.studyDescription);
  $(topRight[1]).text(data.studyDate);


  // On new image (displayed?)
  function onNewImage(e, eventData) {
    // If we are currently playing a clip then update the FPS
    // Get the state of the 'playClip tool'
    var playClipToolData = cornerstoneTools.getToolState(element, 'playClip');

    // If playing a clip ...
    if (playClipToolData !== undefined &amp;&amp; playClipToolData.data.length > 0 &amp;&amp; playClipToolData.data[0].intervalId !== undefined &amp;&amp; eventData.frameRate !== undefined) {

      // Update FPS
      $(bottomLeft[0]).text("FPS: " + Math.round(eventData.frameRate));
      console.log('frameRate: ' + e.frameRate);

    } else {
      // Set FPS empty if not playing a clip
      if ($(bottomLeft[0]).text().length > 0) {
        $(bottomLeft[0]).text("");
      }
    }

    var toolData = cornerstoneTools.getToolState(element, 'stack');
    if (toolData === undefined || toolData.data === undefined || toolData.data.length === 0) {
      return;
    }
    var stack = toolData.data[0];

    // Update Image number overlay
    $(bottomLeft[2]).text("Image # " + (stack.currentImageIdIndex + 1) + "/" + stack.imageIds.length);
  }
  // Add a CornerstoneNewImage event listener on the 'element' (viewer) (?)
  $(element).on("CornerstoneNewImage", onNewImage);


  // On image rendered
  function onImageRendered(e, eventData) {
    // Set zoom overlay text
    $(bottomRight[0]).text("Zoom:" + eventData.viewport.scale.toFixed(2));
    // Set WW/WL overlay text
    $(bottomRight[1]).text("WW/WL:" + Math.round(eventData.viewport.voi.windowWidth) + "/" + Math.round(eventData.viewport.voi.windowCenter));
    // Set render time overlay text
    $(bottomLeft[1]).text("Render Time:" + eventData.renderTimeInMs + " ms");
  }
  // Add a CornerstoneImageRendered event listener on the 'element' (viewer) (?)
  $(element).on("CornerstoneImageRendered", onImageRendered);


}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="server_index.module_js.html">server/index.js</a></li><li><a href="server_utils_fetchImage.module_js.html">server/utils/fetchImage.js</a></li></ul><h3>Classes</h3><ul><li><a href="-_anonymous_-dicomParser.ByteStream.html">ByteStream</a></li><li><a href="-_anonymous_-dicomParser.DataSet.html">DataSet</a></li><li><a href="PDFJS.PageViewport.html">PageViewport</a></li></ul><h3>Global</h3><ul><li><a href="global.html#actualEnv">actualEnv</a></li><li><a href="global.html#cornerstoneFileImageLoader">cornerstoneFileImageLoader</a></li><li><a href="global.html#cornerstoneMath">cornerstoneMath</a></li><li><a href="global.html#displayThumbnail">displayThumbnail</a></li><li><a href="global.html#forEachViewport">forEachViewport</a></li><li><a href="global.html#getStudyList">getStudyList</a></li><li><a href="global.html#ImageViewer">ImageViewer</a></li><li><a href="global.html#loadTemplate">loadTemplate</a></li><li><a href="global.html#requirejs">requirejs</a></li><li><a href="global.html#setupViewport">setupViewport</a></li><li><a href="global.html#setupViewportOverlays">setupViewportOverlays</a></li><li><a href="global.html#studiesPath">studiesPath</a></li><li><a href="global.html#xdr">xdr</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Jun 18 2018 15:48:48 GMT+0100 (WEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
